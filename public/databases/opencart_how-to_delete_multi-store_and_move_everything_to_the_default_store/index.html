<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no minimum-scale=1'>
  <title>TLDR Dev Notes</title>
  <link rel='stylesheet' href='/css/main.css'> 
  <link rel="stylesheet" href="/prism/prism.css">
</head>
<body>

  
<header id="header">
  <div id="logo">
    <h1>TLDR Dev Notes</h1>
  </div>

  <nav id="main-nav">
    
      
        <a href="/">Home</a>
      
        <a href="/about/">About</a>
      
        <a href="/contact/">Contact</a>
      
        <a href="/quotes/">Quotes</a>
      
        <a href="/resources/">Resources</a>
      
        <a href="/progress/">What i did</a>
      
    
  </nav>

</header>


  
  <div id="sidebar">
  <h6>Sections</h6>
  
  <ul id="list-sections">
    
      <li><a href="/api/">
        
        APIs
        </a></li>
    
      <li><a href="/aws/">
        
        Amazon Web Services (AWS)
        </a></li>
    
      <li><a href="/bash-scripting/">
        
        Bash Scripting
        </a></li>
    
      <li><a href="/css-sass/">
        
        CSS &amp; Sass
        </a></li>
    
      <li><a href="/cheatsheets/">
        
        Cheatsheets
        </a></li>
    
      <li><a href="/commands/">
        
        Commands
        </a></li>
    
      <li><a href="/databases/">
        
        Databases
        </a></li>
    
      <li><a href="/drafts/">
        
        Drafts
        </a></li>
    
      <li><a href="/git-github/">
        
        Git &amp; Github
        </a></li>
    
      <li><a href="/javascript/">
        
        JavaScript
        </a></li>
    
      <li><a href="/jekyll/">
        
        Jekyll
        </a></li>
    
      <li><a href="/linux/">
        
        Linux
        </a></li>
    
      <li><a href="/misc/">
        
        Misc
        </a></li>
    
      <li><a href="/node-api/">
        
        Node-api
        </a></li>
    
      <li><a href="/nodejs/">
        
        Node.js
        </a></li>
    
      <li><a href="/opencart/">
        
        OpenCart
        </a></li>
    
      <li><a href="/php/">
        
        PHP
        </a></li>
    
      <li><a href="/programming/">
        
        Programming
        </a></li>
    
      <li><a href="/python/">
        
        Python
        </a></li>
    
      <li><a href="/quotes/">
        
        Quotes
        </a></li>
    
      <li><a href="/raspberrypi/">
        
        Raspberry Pi
        </a></li>
    
      <li><a href="/reactjs/">
        
        Reactjs
        </a></li>
    
      <li><a href="/redux/">
        
        Redux
        </a></li>
    
      <li><a href="/resources/">
        
        Resources
        </a></li>
    
      <li><a href="/sysadmin/">
        
        System Administration
        </a></li>
    
      <li><a href="/webdev/">
        
        Web Development
        </a></li>
    
      <li><a href="/workflow/">
        
        Workflow
        </a></li>
    
      <li><a href="/ios-swift/">
        
        iOS &amp; Swift
        </a></li>
    
        </ul>

  
  <section>
    <h6>Tags</h6>
    
      <a href="/tags/amazon-rds">amazon-rds</a>, 
    
      <a href="/tags/amazon-s3">amazon-s3</a>, 
    
      <a href="/tags/api">api</a>, 
    
      <a href="/tags/array-methods">array-methods</a>, 
    
      <a href="/tags/aws">aws</a>, 
    
      <a href="/tags/babel">babel</a>, 
    
      <a href="/tags/backups">backups</a>, 
    
      <a href="/tags/bash">bash</a>, 
    
      <a href="/tags/basics">basics</a>, 
    
      <a href="/tags/bluetooth">bluetooth</a>, 
    
      <a href="/tags/cheatsheet">cheatsheet</a>, 
    
      <a href="/tags/cli">cli</a>, 
    
      <a href="/tags/commands">commands</a>, 
    
      <a href="/tags/compass">compass</a>, 
    
      <a href="/tags/concepts">concepts</a>, 
    
      <a href="/tags/coreblueooth">coreblueooth</a>, 
    
      <a href="/tags/crontab">crontab</a>, 
    
      <a href="/tags/css">css</a>, 
    
      <a href="/tags/database">database</a>, 
    
      <a href="/tags/databases">databases</a>, 
    
      <a href="/tags/date">date</a>, 
    
      <a href="/tags/debian">debian</a>, 
    
      <a href="/tags/editor">editor</a>, 
    
      <a href="/tags/education">education</a>, 
    
      <a href="/tags/es2015">es2015</a>, 
    
      <a href="/tags/firebase">firebase</a>, 
    
      <a href="/tags/format">format</a>, 
    
      <a href="/tags/free">free</a>, 
    
      <a href="/tags/fundamentals">fundamentals</a>, 
    
      <a href="/tags/getting-started">getting-started</a>, 
    
      <a href="/tags/git">git</a>, 
    
      <a href="/tags/github-pages">github-pages</a>, 
    
      <a href="/tags/guides">guides</a>, 
    
      <a href="/tags/hacking">hacking</a>, 
    
      <a href="/tags/hosting">hosting</a>, 
    
      <a href="/tags/how-to">how-to</a>, 
    
      <a href="/tags/hugo">hugo</a>, 
    
      <a href="/tags/ios">ios</a>, 
    
      <a href="/tags/javascript">javascript</a>, 
    
      <a href="/tags/jekyll">jekyll</a>, 
    
      <a href="/tags/js">js</a>, 
    
      <a href="/tags/keychain">keychain</a>, 
    
      <a href="/tags/lamp">lamp</a>, 
    
      <a href="/tags/lfs">lfs</a>, 
    
      <a href="/tags/linux">linux</a>, 
    
      <a href="/tags/macos">macos</a>, 
    
      <a href="/tags/markdown">markdown</a>, 
    
      <a href="/tags/media-queries">media-queries</a>, 
    
      <a href="/tags/mongodb">mongodb</a>, 
    
      <a href="/tags/mysql">mysql</a>, 
    
      <a href="/tags/nagios">nagios</a>, 
    
      <a href="/tags/node">node</a>, 
    
      <a href="/tags/nodejs">nodejs</a>, 
    
      <a href="/tags/npm">npm</a>, 
    
      <a href="/tags/opencart">opencart</a>, 
    
      <a href="/tags/phpmyadmin">phpmyadmin</a>, 
    
      <a href="/tags/programming">programming</a>, 
    
      <a href="/tags/python">python</a>, 
    
      <a href="/tags/raspberry-pi">raspberry-pi</a>, 
    
      <a href="/tags/react">react</a>, 
    
      <a href="/tags/react-router">react-router</a>, 
    
      <a href="/tags/reactjs">reactjs</a>, 
    
      <a href="/tags/redux">redux</a>, 
    
      <a href="/tags/s3">s3</a>, 
    
      <a href="/tags/sass">sass</a>, 
    
      <a href="/tags/script">script</a>, 
    
      <a href="/tags/scripts">scripts</a>, 
    
      <a href="/tags/snippets">snippets</a>, 
    
      <a href="/tags/sql">sql</a>, 
    
      <a href="/tags/ssh">ssh</a>, 
    
      <a href="/tags/steganography">steganography</a>, 
    
      <a href="/tags/sublime-text">sublime-text</a>, 
    
      <a href="/tags/sync">sync</a>, 
    
      <a href="/tags/sysadmin">sysadmin</a>, 
    
      <a href="/tags/system-management">system-management</a>, 
    
      <a href="/tags/table">table</a>, 
    
      <a href="/tags/terminal">terminal</a>, 
    
      <a href="/tags/ubuntu">ubuntu</a>, 
    
      <a href="/tags/wifi">wifi</a>, 
    
      <a href="/tags/wordpress">wordpress</a>, 
    
      <a href="/tags/workflow">workflow</a>, 
    
  </section>

  <section>
    <h6>Most Used Tags</h6>
    
      <a href="/tags/linux">linux</a>,
    
      <a href="/tags/es2015">es2015</a>,
    
      <a href="/tags/how-to">how-to</a>,
    
      <a href="/tags/array-methods">array-methods</a>,
    
      <a href="/tags/bash">bash</a>,
    
      <a href="/tags/commands">commands</a>,
    
      <a href="/tags/cheatsheet">cheatsheet</a>,
    
      <a href="/tags/concepts">concepts</a>,
    
      <a href="/tags/mysql">mysql</a>,
    
      <a href="/tags/free">free</a>,
    
      <a href="/tags/sass">sass</a>,
    
      <a href="/tags/compass">compass</a>,
    
      <a href="/tags/python">python</a>,
    
      <a href="/tags/backups">backups</a>,
    
      <a href="/tags/editor">editor</a>,
    
      <a href="/tags/hugo">hugo</a>,
    
      <a href="/tags/opencart">opencart</a>,
    
      <a href="/tags/raspberry-pi">raspberry-pi</a>,
    
      <a href="/tags/basics">basics</a>,
    
      <a href="/tags/database">database</a>,
    
  </section>


</div>


  
  <div id="main">


<h1 class="post_title">OpenCart: Delete Multi-Store and Move Everything to the Default Store</h1>


<div class="post_meta">
  
    
    
  
    
    
    
      <div class="meta_date"><strong>Last updated on:</strong> Feb 26, 2015</div>
    
  
    
    
    <div class="meta_section"><strong>Section:</strong> 
      
        <a href="/databases">Databases</a>
          
    </div>


    
     
      <div class="meta_tags">
        <strong>Tags:</strong>
        
         
        
          
            <a href="/tags/how-to">#how-to</a>
          
            <a href="/tags/opencart">#opencart</a>
          
            <a href="/tags/mysql">#mysql</a>
          
            <a href="/tags/phpmyadmin">#phpmyadmin</a>
          
        
      </div>
    
  
  </div>



<div class="content">
    

<p>Make a BACKUP before doing anything to the database. Be safe.</p>

<h3 id="assumptions">Assumptions</h3>

<p>This post assumes that</p>

<ul>
<li>the store_id for Default store is 0</li>
<li>you have only 1 multi-store</li>
<li>you are moving things from Multi-store to Default store</li>
<li>you want to delete Multi-Store</li>
<li>you have products that were added to both Default and Multi-store</li>
<li>everything means products, categories, manufacturers and information</li>
</ul>

<p>We can&rsquo;t delete a multi-store if there are orders associated with it. So the first step of the process would be to update all existing orders to associate with our main (default) store.</p>

<h2 id="update-store-details-for-all-existing-orders">Update Store details for all existing Orders</h2>

<p>The table to edit is <code>oc_order</code> and the columns we&rsquo;ll be editing are <code>store_id</code>, <code>store_name</code> and <code>store_url</code>. The <code>store_id</code> for the Default store is <strong>0</strong>.</p>

<pre><code class="language-sql">UPDATE `oc_order` SET `store_id`=0,`store_name`=&quot;Cakebox.ME&quot;, `store_url`=&quot;http://cakebox.me&quot;
</code></pre>

<p>Using this command, you can change Store details for all existing orders. Once you have linked all existing orders to the default store, you can go to the Admin and delete the multi-store.</p>

<h2 id="cleanup">Cleanup</h2>

<p>After we&rsquo;re done with deleting multi-store, we need to do cleanup. For every Product, Category, Manufacturer, and Information page that was linked to the multi-store, there&rsquo;ll be a row in the database saying so. If you had hundreds of products for your multi-store, there&rsquo;ll be hundreds of rows for it in the database.</p>

<p>We need to <strong>a</strong>) update these rows to link to our Default store (in case you are moving everything to the default) and <strong>b</strong>) remove duplicates (in case you added a product to your default as well as multi-store, because then the same product will have a row for every store).</p>

<p>The cleanup, while not necessary, is recommended. You can go by without doing it, but if you have hundreds of useless rows in the database, it&rsquo;ll only slow things down and effect performance. Delete them to make your site faster.</p>

<p><strong>Note</strong>: You can use <a href="#">this extension</a> to Bulk move products, categories and manufacturers between stores. It&rsquo;ll, however, not delete duplicates.</p>

<h3 id="update-store-id-for-all-existing-products">Update Store ID for all existing Products</h3>

<p>The table to edit is <code>oc_product_to_store</code>, the column is <code>store_id</code>. We are going to delete duplicates first and then update all products to link them to Default store.</p>

<p>Show all Products that are duplicates and are not linked to Default store</p>

<pre><code class="language-sql">SELECT * FROM `oc_product_to_store` WHERE `product_id` = `product_id` AND `store_id` != 0;
</code></pre>

<p>Delete duplicates</p>

<pre><code class="language-sql">DELETE FROM `oc_product_to_store` WHERE `product_id` = `product_id` AND `store_id` != 0;
</code></pre>

<p>Link all products to Default store</p>

<pre><code class="language-sql">UPDATE `oc_product_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
</code></pre>

<p>If you get</p>

<pre><code># MySQL returned an empty result set (i.e. zero rows).
</code></pre>

<p>that&rsquo;s fine. It means that after deleting the duplicates, there were no products that didn&rsquo;t already link to the Default store.</p>

<h3 id="update-store-id-for-all-existing-categories">Update Store ID for all existing Categories</h3>

<p>The table to edit is <code>oc_category_to_store</code>, the column is <code>store_id</code>.</p>

<p>Show all Categories that are duplicates and are not linked to Default store</p>

<pre><code class="language-sql">SELECT * FROM `oc_category_to_store` WHERE `category_id` = `category_id` AND `store_id` != 0
</code></pre>

<p>Delete them</p>

<pre><code class="language-sql">DELETE FROM `oc_category_to_store` WHERE `category_id` = `category_id` AND `store_id` != 0
</code></pre>

<p>Link all Categories to Default store</p>

<pre><code class="language-sql">UPDATE `oc_category_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
</code></pre>

<h3 id="update-store-id-for-all-existing-manufacturers">Update Store ID for all existing Manufacturers</h3>

<p>The table to edit is <code>oc_manufacturer_to_store</code>, the column is <code>store_id</code>.</p>

<p>Show all Manufacturers that are duplicates and are not linked to Default store</p>

<pre><code class="language-sql">SELECT * FROM `oc_manufacturer_to_store` WHERE `manufacturer_id` = `manufacturer_id` AND `store_id` != 0
</code></pre>

<p>Delete them</p>

<pre><code class="language-sql">DELETE FROM `oc_manufacturer_to_store` WHERE `manufacturer_id` = `manufacturer_id` AND `store_id` != 0
</code></pre>

<p>Link all Manufacturers to Default store</p>

<pre><code class="language-sql">UPDATE `oc_manufacturer_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
</code></pre>

<h3 id="update-store-id-for-all-existing-information-pages">Update Store ID for all existing Information pages</h3>

<p>The table to edit is <code>oc_information_to_store</code>, the column is <code>store_id</code>.</p>

<p>Show all Information pages that are duplicates and are not linked to Default store</p>

<pre><code class="language-sql">SELECT * FROM `oc_information_to_store` WHERE `information_id` = `information_id` AND `store_id` != 0
</code></pre>

<p>Delete them</p>

<pre><code class="language-sql">DELETE FROM  `oc_information_to_store` WHERE  `information_id` =  `information_id` AND  `store_id` !=0
</code></pre>

<p>Link all Information pages to Default store</p>

<pre><code class="language-sql">UPDATE `oc_information_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
</code></pre>

<h2 id="get-everything-done-in-one-step">Get everything done in one step</h2>

<p>The following code deletes duplicates and updates _store<em>id</em> for all products, categories, manufacturers and information in one go. Only use this if you understand everything i have explained above, are confident in what you are doing and have a backup that you can restore if anything goes wrong.</p>

<pre><code class="language-sql">DELETE FROM `oc_product_to_store` WHERE `product_id` = `product_id` AND `store_id` != 0;
DELETE FROM `oc_category_to_store` WHERE `category_id` = `category_id` AND `store_id` != 0;
DELETE FROM `oc_manufacturer_to_store` WHERE `manufacturer_id` = `manufacturer_id` AND `store_id` != 0;
DELETE FROM `oc_information_to_store` WHERE  `information_id` =  `information_id` AND  `store_id` !=0;

UPDATE `oc_product_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
UPDATE `oc_category_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
UPDATE `oc_manufacturer_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
UPDATE `oc_information_to_store` SET `store_id` = 0 WHERE `store_id` != 0;
</code></pre>

<p>That&rsquo;s it. You should now have all existing products, categories, manufacturers and information linked to your Default store, have no duplicates and gotten rid of your multi-store.</p>

</div>






  <div class="related">
    <h6>Related</h6>
      <ul>
        
          <li><a href="/databases/bulk-update-product-prices-opencart-phpmyadmin-mysql/">OpenCart: Bulk update prices of Products</a></li>
        
          <li><a href="/databases/querying-selecting-showing-data-from-mysql-database-tips/">Tips for Querying a MySQL Database</a></li>
        
          <li><a href="/databases/database-foundations/">Database Foundations</a></li>
        
          <li><a href="/bash-scripting/create-ocmod-vqmod-template-opencart-bash-script/">Bash script to create OCMOD and vQmod templates with a single command</a></li>
        
          <li><a href="/git-github/getting-started-github-pages/">Getting started with Github Pages</a></li>
        
      </ul>
  </div>



<footer id="footer">
<hr>
  <section>
    Please note that this site and the posts on it are, and will always be, a work in progress. If i waited for perfection, i’d never get anything done.
  </section>
  <span class="copyright"> Copyright &copy; 2014 - 2015 Aamnah. All rights reserved.</span>
</footer>

</div>

<script src='/prism/prism.js'></script>
</body>
</html>